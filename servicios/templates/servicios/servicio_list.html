

{% extends "../baselist.html" %}
{% load crispy_forms_tags %}
{% load static %}

{% block title %}
Buscar Servicio
{% endblock %}


    {% block tlista %} Listado de Servicios {% endblock %}

    {% block tExtras %} 
    
        {% if cliente %}
            <a href="{% url 'servicios:crearServicioParaCliente' cliente.pk %}" class="bi bi-plus-circle-fill text-success fs-5"></a>
        {% else %}
            <a href="{% url 'servicios:crearServicio' %}" class="bi bi-plus-circle-fill text-success fs-5"></a>
        {% endif %}
    {% endblock %}
    {% block thextras %}
        <th colspan="">Opciones</th>
        <th colspan="">Informacion</th>
    {% endblock%}
    
    {% block tcuerpo %}
    {% for s in servicio %}
    <tr>
        <td>{{forloop.counter}}</td>
        <td>{{s.estado_actual}}</td>
        <td>{{s.desde}}</td>
        <td>{{s.hasta}}</td>
        <td>{{s.cantidadEstimadaEmpleados}}</td>
        <td>{{s.totalEstimado}}</td>



        <td>
        {% if s.estado.tipo == s.estado.Tipo.PRESUPUESTADO %}
            <button type="button" class="btn btn-primary">Contratar</button>
        {% endif %}
        </td>

        <td>
        {% if cliente %}
            <a href="#" onclick="abrir_modal('{% url "servicios:modificarServicioParaCliente" cliente_pk=s.inmueble.cliente.pk pk=s.pk %}')" class="bi bi-pencil-square text-primary"> </a>
        {% else %}
            <a href="#" onclick="abrir_modal('{% url "servicios:modificarServicio" pk=s.pk %}')" class="bi bi-pencil-square text-primary"> </a>
        {% endif %}
        </td>

    </tr>

    

    {% empty %}
    <tr> <td> No hay servicios registrados </td> </tr>
    {% endfor %}

    
{% endblock %}



{% block extrajs %}
<!--Modal-->
<script type="text/javascript">
var $ = jQuery.noConflict();
function abrir_modal(url){
    $('#modal').load(url, function(){
        $(this).modal('show');
        bindFormSet($('#modal'));
    });
}
</script>
{% endblock %}